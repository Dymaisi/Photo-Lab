{% extends 'layout/function.html' %}

{% load static %}
{% block body %}
<div class="bg bg-blur"></div>
<div class="content-wrapper">
    <div class="container" style="padding-top:20px">
        <div style="display:grid; justify-self: center;justify-content:center;grid-template-columns: 300px 1200px;">
            <div id="style" style="background: transparent;width:200px;height: 200px;margin-left:232px">
                <img src="{% static 'image/img_default.png' %}"
                     style=" max-width: 100%;max-height: 100%;"/>
            </div>
            <header class="codrops-header">
                <h1>风格迁移</h1>
                <p>选择想要的风格或自己上传风格图，再选择照片</p>
            </header>
        </div>

        <div class="effect-group-container toolbar-2" style="background:transparent">
            <form enctype="multipart/form-data" action="/uploadFile/" method="post"
                  style="display:grid; justify-self: center;justify-content:center;
                  grid-template-columns: 400px 400px 400px;place-items: center;transform:translate(-15px,0)">
                <div id="select">
                    <section id="basic-usage">
                        <select class="selectpicker" data-style="btn-info">
                            <option value="">选择风格</option>
                            <option>浮世绘</option>
                            <option>星空</option>
                            <option>Vehicula Ornare</option>
                            <option>Foo</option>
                            <option>Bar</option>
                            <option>Baz</option>
                            <option>Qux</option>
                            <option>Zoobie</option>
                            <option>Frang</option>
                        </select>
                    </section>
                </div>
                <div class="btn-border btn-round btn-blue" style="width:200px;height:38px;">
                    <label id="realBtn1" class="btn btn-primary btn-block" style="background:blue;width:200px;height:38px">
                        <input type="file" id="chooseStyle" name="file" class="mFileInput"
                               onclick="showImg('chooseStyle','style')"
                               style="left:-9999px;position:absolute;">
                        <span>自定义风格</span>
                    </label>
                </div>
                <div class="btn-border btn-round btn-blue" style="width:200px;height:38px;">
                    <label id="realBtn2" class="btn btn-primary btn-block" style="background:blue;width:200px;height:38px">
                        <input type="file" id="chooseImage" name="file" class="mFileInput"
                               style="left:-9999px;position:absolute;">
                        <span>上传图片</span>
                    </label>
                </div>
            </form>
        </div>

        <section class="demo-3">
            <div class="grid"
                 style="display: grid;grid-template-columns: 650px 650px ;grid-template-rows: 400px; justify-self: center;justify-content:center">
                <div class="box" style="width:600px;height:400px">
                    <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
                        <line class="top" x1="0" y1="0" x2="1800" y2="0"/>
                        <line class="left" x1="0" y1="400" x2="0" y2="-800"/>
                        <line class="bottom" x1="600" y1="400" x2="-1200" y2="400"/>
                        <line class="right" x1="600" y1="0" x2="600" y2="1200"/>
                    </svg>
                    <div id="image" style="  background: transparent;width:100%;height: 100%;">
                        <img src="{% static 'image/img_default.png' %}"
                             style=" max-width: 95%;max-height: 95%;position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);"/>
                    </div>
                </div>
                <div class="box" style="width:600px;height:400px">
                    <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
                        <line class="top" x1="0" y1="0" x2="1800" y2="0"/>
                        <line class="left" x1="0" y1="400" x2="0" y2="-800"/>
                        <line class="bottom" x1="600" y1="400" x2="-1200" y2="400"/>
                        <line class="right" x1="600" y1="0" x2="600" y2="1200"/>
                    </svg>
                    <div id="canvas" style="display:none;position:absolute;left:190px;top:60px;opacity:0.5">
                        <div class="circle" id="circle"  style="color:#2c3e50;"></div>
                    </div>
                    <div id="image_get" style="  background: transparent;width:100%;height: 100%;">
                        <img src="{% static 'image/img_default.png' %}"
                             style=" max-width: 95%;max-height: 95%;position: absolute;left: 50%;top: 50%;transform: translate(-50%, -50%);"/>
                    </div>
                </div>
            </div><!-- /grid -->
        </section>

    </div><!-- /container -->
</div>

<script src="{% static 'js/button.js' %}"></script>
<script src="{% static 'js/jquery-2.1.0.min.js' %}"></script>
<script src="{% static 'js/fancySelect.js' %}"></script>
<script src="{% static 'js/circles.min.js' %}"></script>
<script>
    var color = ['#2c3e50','#999cbc'];
    var child = document.getElementById('circle');
    var percentage = 1.19;
    var circle = Circles.create({
        id:         child.id,
        value:		percentage,
        radius:     100,
        width:      20,
        colors:     color,
        duration: 9999,
    });
    document.getElementById("chooseImage").onclick = function () {
        var batchUpload = document.querySelector('#chooseImage');
        batchUpload.click();
        batchUpload.addEventListener('change', function () {
            var filesList = document.querySelector('#chooseImage').files;
            if (filesList.length == 0) { //若是取消上传，则该文件的长度为0
                return;
            } else {
                var imgFile = filesList[0];
                var name = imgFile.name;
                var className = name.substring(name.lastIndexOf(".")).toLowerCase();
                if (!className.match(/.png|.jpg|.jpeg/)) {
                    alert("暂只支持jpg、jpeg、png格式图片，请重新选择！");
                    return;
                };
                var fr = new FileReader();
                fr.onload = function () {
                    document.getElementById('image').getElementsByTagName('img')[0].src = fr.result;
                };
                fr.readAsDataURL(imgFile);
                document.getElementById('canvas').style.display = "block";
                circle.update(1.19, 9999);
                circle.update(circle._value + 90, 9999);
            }
        });
    };

</script>

<script type="text/javascript">
    $(document).ready(function(){
        $('#basic-usage-demo').fancySelect();
    });
</script>
{% endblock %}
{% block javascript %}
{% endblock %}